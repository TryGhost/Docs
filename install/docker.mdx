---
title: "How To Install Ghost With Docker (preview)"
description: Preview our new batteries-included tools for self-hosting Ghost using Docker compose.
---

## Overview

With the launch of Ghost 6.0 we are also previewing a new suite of tooling for self-hosters built on Docker with compose.
We invite you to be one of the first to try hosting Ghost with this new tooling, which comes with full support for self-hosting
both the Social Web (ActivityPub) and Web Analytics (Tinybird) features.

### Why Docker?

So that we can continue adding advanced features to Ghost without creating bloat, we're starting to build some features as separate services.
Using Docker and Docker compose takes all the pain out of managing different services and their dependencies, meaning we can keep Ghost's architecture simple
without passing on complexity to our self-hosting community. All services are Open Source and can be self-hosted.

## Pre-requisites
- A Linux-based server with Docker installed (we recommend )
- A domain name with a DNS **A-Record** pointing to the serverâ€™s IP address
- An SMTP email service for transactional mail [More info](/config/#mail)
- (Optional) A [tinybird](https://www.tinybird.co/) account for web analytics


---

## Install Ghost

This section will get you a fresh setup of a working Ghost instance.

It will install the Ghost service, Caddy as a webserver and MySQL for the database.


### Clone the repo

Make a local copy of our docker tooling repository in `/opt/ghost`:

```bash
git clone https://github.com/TryGhost/ghost-docker.git /opt/ghost && cd /opt/ghost
```

### Setup your config

Copy the example config files for [Ghost](https://github.com/TryGhost/ghost-docker/blob/main/.env.example) and [Caddy](https://github.com/TryGhost/ghost-docker/blob/main/caddy/Caddyfile.example):

```bash
cp .env.example .env
cp caddy/Caddyfile.example caddy/Caddyfile
```

Edit the `.env` file and change:

1. `DOMAIN` : this is your custom domain for your Ghost site e.g. mysite.com
2. `ADMIN_DOMAIN` : a separate domain for your Ghost admin e.g. admin.mysite.com (Optional, recommended)
3. `DATABASE_ROOT_PASSWORD` : generate a random password with `openssl rand -hex 32`
4. `DATABASE_PASSWORD` : generate a random password using `openssl rand -hex 32`
5. SMTP Email section : your chosen SMTP service's configuration (See: [email config docs](/config/#mail))

If you're using www in `DOMAIN`, you'll need to do option 3 in the next section to ensure ActivityPub works correctly.

### (Optional) Domain setup in Caddy

The Caddyfile is setup for various domain setups. You can get to your desired setup by uncommenting the relevant blocks.

Edit the `Caddyfile` in `caddy/Caddyfile`:

1. For separate admin domains (recommended), uncomment the "Separate admin domains" block
2. If you're using a root or "naked" domain like mysite.com for `DOMAIN` in `.env`:
Redirect the www variant to your root domain by setting up DNS for both domains and then uncomment the "Redirect www -> root domain" block.
3. If you're using a www domain for `DOMAIN` in `.env`:
Redirect your root domain to the www variant by setting up DNS for both domains, then uncomment the "Redirect root -> www domain" block" and set `CHANGE_ME` to your root domain without the www. This is required for ActivityPub to work correctly with www domains.

You only need to uncomment blocks, and if necessary edit `CHANGE_ME`. All the other variables come from `.env` and should be left as-is.

### Install and run Ghost

Use docker compose commands to install and run your Ghost site. These commands may each take a little while:

```bash
docker compose pull
docker compose up -d
```

Now your site is running! Open a browser and navigate to your domain to see Ghost in action.

Navigate to the admin panel on `/ghost` to complete your setup ðŸŽ‰


## Enabling Web Analytics

This section assumes youâ€™ve completed a fresh setup from the section above or have migrated an existing site to Docker.

### Get Tinybird setup

Make sure you have a [tinybird](https://www.tinybird.co/) account with a workspace. You can choose any cloud and region. Then, making sure you're still inside of `/opt/ghost`, run the following 4 commands:


```bash
docker compose run --rm tinybird-login
```

Follow the steps to login to your Tinybird account.

```bash
docker compose run --rm tinybird-sync
```

Copy the Tinybird schema files from the Ghost container into a shared volume. The service should log "Tinybird files synced into shared volume.", then exit.

```bash
docker compose run --rm tinybird-deploy
```

Deploy your tinybird configuration. This will create your Tinybird datasources, pipes and API endpoints. It may take a minute or two to complete the first time. You should see "Deployment #1 is live!" in your terminal before the service exits.

```bash
docker compose run --rm tinybird-login get-tokens
```

Get your tinybird tokens

### Edit the .env file

Copy and paste the values from the previous step into the "Tinybird configuration" section.

Add `analytics` to the `COMPOSE_PROFILES` variable at the top. This automatically includes the `analytics` profile when running `docker compose` commands:

```bash
COMPOSE_PROFILES=analytics,activitypub

# Alternatively if you only want analytics
COMPOSE_PROFILES=analytics
```

### Install and run Ghost with Web Analytics

Use docker compose to install new images and run Ghost with Web Analytics:

```bash
docker compose pull
docker compose up -d
```

Verify it's working by visiting your homepage and then checking the visit appears in the "Analytics" section of Ghost admin.



## Enabling Social Web (ActivityPub)

By default, all new Ghost installs are configured to use the Ghost(Pro) hosted ActivityPub Service, meaning the Social Web features work out of the box.
This hosted service is free to use for all self-hosters, with some [usage limits]()

If you would like to host the ActivityPub Service yourself, follow these steps:

### Edit the .env file

Add `acitvitypub` to the `COMPOSE_PROFILES` variable at the top. This automatically includes the `activitypub` profile when running `docker compose` commands:

```bash
COMPOSE_PROFILES=analytics,activitypub

# Alternatively if you only want activitypub
COMPOSE_PROFILES=activitypub
```


Next, uncomment the `ACTIVITYPUB_TARGET` line to point to your local install. It should look like this:

```bash
ACTIVITYPUB_TARGET=activitypub:8080
```


### Install and run Ghost with ActivityPub

Use docker compose to install new images and run Ghost with ActivityPub:

```bash
docker compose pull
docker compose up -d --force-recreate ghost
```

Verify it's working by visiting the "Network" section of Ghost Admin.

### Hosted ActivityPub Usage Limits
Self-hosters are free to use the hosted ActivityPub service, up to the following limits:

* 2000 max. followers
* 2000 max. following
* max. 100 interactions per day (interactions include: create a post/note, reply, like, repost)

If your usage exceeds this, you'll need to switch to self-hosting ActivityPub as explained above.

---

## Future maintenance

Use docker compose to update Ghost regularly:

```bash
# ensure you're in the directory where you installed ghost and pull the latest configuration
cd /opt/ghost
git pull

# pull the latest images and restart to use them
docker compose pull
docker compose up -d

# optionally clean up old images
docker image prune
```

Or the one-liner, if you're in the directory where you cloned the docker tools:

```bash
git pull && docker compose pull && docker compose up -d
```

---

## Migrating a Ghost-CLI Install

TK

## Tinybird Integration

TK

***

## Resources

TK